<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trivia del Agua - Cultura H√≠drica</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #333;
            padding: 1rem;
            box-sizing: border-box;
        }

        .container {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            width: 90%;
            max-width: 600px;
            text-align: center;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        h1, h2 {
            color: #005a9c;
        }

        /* --- Estilos del campo de nombre --- */
        .name-input {
            width: 80%;
            padding: 10px;
            margin-top: 1.5rem;
            border-radius: 20px;
            border: 2px solid #66a6ff;
            font-size: 1rem;
            text-align: center;
        }

        .name-input:focus {
            outline: none;
            border-color: #005a9c;
        }

        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s, transform 0.2s;
            margin-top: 1rem;
        }

        button:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }

        .btn-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 1.5rem;
        }

        .btn {
            background-color: #66a6ff;
            border: 2px solid transparent;
            padding: 15px;
            border-radius: 10px;
            font-size: 1rem;
            color: white;
            cursor: pointer;
        }

        .btn:hover {
            border-color: #005a9c;
        }

        .btn:disabled {
             cursor: not-allowed;
        }

        .btn.correct {
            background-color: #28a745;
        }

        .btn.wrong {
            background-color: #dc3545;
        }

        .feedback {
            margin-top: 1rem;
            font-size: 1.1rem;
            font-weight: bold;
            height: 20px;
        }

        #result-message {
            font-size: 1.2rem;
            margin-top: 1rem;
            color: #005a9c;
        }

        /* --- Estilos del Certificado --- */
        #certificate-screen h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            color: #005a9c;
        }
        
        #certificate-name {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            color: #007bff;
            border-bottom: 2px solid #66a6ff;
            padding-bottom: 5px;
            display: inline-block;
        }

        .certificate-container {
            border: 10px solid #66a6ff;
            padding: 2rem;
            background-color: #f8f9fa;
            border-radius: 10px;
            position: relative;
        }

        .certificate-score-text {
            font-size: 1.1rem;
            color: #005a9c;
            margin-top: 1rem;
            font-weight: 600;
        }

        .certificate-container::before {
            content: 'üíß';
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 2rem;
            opacity: 0.2;
        }
        
        .certificate-container::after {
            content: 'üåç';
            position: absolute;
            bottom: 20px;
            right: 20px;
            font-size: 2rem;
            opacity: 0.2;
        }

        .certificate-title {
            font-size: 1.5rem;
            margin: 1rem 0;
            font-weight: 600;
        }

        .certificate-text {
            font-size: 1.1rem;
            margin: 2rem 0;
        }

        .certificate-date {
            font-size: 0.9rem;
            color: #555;
            margin-top: 2rem;
        }
        

        @media print {
            body {
                background: none;
            }
            .container {
                box-shadow: none;
                border: none;
                width: 100%;
                max-width: 100%;
            }
            .no-print, #restart-button-cert {
                display: none;
            }
        }

        .game-logo {
            max-width: 80px;
            height: auto;
            margin: 5px 0;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }
        .game-logo:hover {
            transform: scale(1.05);
        }

        /* Estilos para botones de dificultad */
        .difficulty-btn {
            transition: all 0.3s ease;
            font-weight: 500;
            border: 2px solid #66a6ff !important;
            background: white !important;
            color: #66a6ff !important;
        }

        .difficulty-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(102, 166, 255, 0.3);
        }

        .difficulty-btn.selected {
            background: #66a6ff !important;
            color: white !important;
            box-shadow: 0 4px 8px rgba(102, 166, 255, 0.4);
        }

        /* Estilos para barra de progreso */
        .progress-bar-container {
            background-color: #e0e0e0;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        #progress-bar {
            background: linear-gradient(90deg, #66a6ff, #89f7fe);
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 4px;
        }

    </style>
</head>
<body>
    <div class="container">
        <div id="start-screen" class="screen active">
            <img src="imagenes/logo.png" alt="Logo AquaGuard" class="game-logo">
            <h1>üåä Trivia del Agua üíß</h1>
            <p>¬øQu√© tanto sabes sobre el cuidado del agua? ¬°Ponte a prueba!</p>
            <input type="text" id="name-input" class="name-input" placeholder="Escribe tu nombre aqu√≠">
            
            <div class="difficulty-selection" style="margin: 20px 0;">
                <label style="display: block; margin-bottom: 10px; font-weight: bold; color: #005a9c;">Selecciona la modalidad:</label>
                <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap;">
                    <button class="difficulty-btn" data-questions="5" style="padding: 10px 15px; border: 2px solid #66a6ff; background: white; color: #66a6ff; border-radius: 25px; cursor: pointer; transition: all 0.3s;">
                        R√°pido (5 preguntas)
                    </button>
                    <button class="difficulty-btn selected" data-questions="10" style="padding: 10px 15px; border: 2px solid #66a6ff; background: #66a6ff; color: white; border-radius: 25px; cursor: pointer; transition: all 0.3s;">
                        Normal (10 preguntas)
                    </button>
                    <button class="difficulty-btn" data-questions="15" style="padding: 10px 15px; border: 2px solid #66a6ff; background: white; color: #66a6ff; border-radius: 25px; cursor: pointer; transition: all 0.3s;">
                        Experto (15 preguntas)
                    </button>
                </div>
            </div>
            
            <button id="start-button">Comenzar</button>
        </div>

        <div id="question-screen" class="screen">
            <div class="progress-container" style="margin-bottom: 20px;">
                <div id="question-counter" style="text-align: center; font-weight: bold; color: #005a9c; margin-bottom: 10px;">Pregunta 1 de 10</div>
                <div class="progress-bar-container" style="background-color: #e0e0e0; height: 8px; border-radius: 4px; overflow: hidden;">
                    <div id="progress-bar" style="background: linear-gradient(90deg, #66a6ff, #89f7fe); height: 100%; width: 0%; transition: width 0.3s ease;"></div>
                </div>
            </div>
            <div id="question-container">
                <h2 id="question-text"></h2>
                <div id="answer-buttons" class="btn-grid"></div>
            </div>
            <div id="feedback" class="feedback"></div>
        </div>

        <div id="result-screen" class="screen">
            <h2>Resultados Finales</h2>
            <p>Obtuviste <span id="score"></span> de <span id="total-questions"></span> preguntas correctas.</p>
            <p id="result-message"></p>
            <button id="restart-button" class="no-print">Intentar de Nuevo</button>
            <button id="home-button">Salir</button>
        </div>
        
        <div id="certificate-screen" class="screen">
            <div class="certificate-container">
                <h2>¬°Felicidades!</h2>
                <img src="imagenes/logo.jpg" alt="Logo AquaGuard" class="game-logo" style="margin-top: 1rem;">
                <p class="certificate-text">
                    Se otorga este reconocimiento como
                </p>
                <p class="certificate-title">Guardi√°n del Agua</p>
                <p>a:</p>
                <span id="certificate-name"></span>
                <p class="certificate-text">
                    por haber demostrado un conocimiento
                    excepcional sobre la cultura h√≠drica y los Objetivos de Desarrollo Sostenible.
                </p>
                <p class="certificate-score-text">
                    Puntaje obtenido: <span id="certificate-score" style="font-weight: bold; color: #007bff;"></span>
                </p>
                
                <p class="certificate-date" id="certificate-date-text"></p>
            </div>
            <button id="print-button" class="no-print">Imprimir Certificado</button>
            <button id="restart-button-cert" class="no-print">Volver a Jugar</button>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const startButton = document.getElementById('start-button');
            const restartButton = document.getElementById('restart-button');
            const restartButtonCert = document.getElementById('restart-button-cert');
            const homeButton = document.getElementById('home-button');
            homeButton.addEventListener('click', () => window.location.href = 'index.html');
            const printButton = document.getElementById('print-button');

            const nameInput = document.getElementById('name-input');
            const startScreen = document.getElementById('start-screen');
            const questionScreen = document.getElementById('question-screen');
            const resultScreen = document.getElementById('result-screen');
            const certificateScreen = document.getElementById('certificate-screen');

            const questionText = document.getElementById('question-text');
            const answerButtons = document.getElementById('answer-buttons');
            const feedback = document.getElementById('feedback');
            
            const scoreSpan = document.getElementById('score');
            const totalQuestionsSpan = document.getElementById('total-questions');
            const resultMessage = document.getElementById('result-message');
            const certificateDateText = document.getElementById('certificate-date-text');
            const certificateName = document.getElementById('certificate-name');

            let currentQuestionIndex, score, playerName, selectedQuestions, maxQuestions;

            // Configuraci√≥n din√°mica
            const TOTAL_QUESTIONS_TO_SHOW = 10; // Puedes cambiar este n√∫mero
            const SHUFFLE_ANSWERS = true; // Mezclar respuestas
            const SHUFFLE_QUESTIONS = true; // Mezclar preguntas

            // Funciones para aleatorizaci√≥n
            function shuffleArray(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }

            function selectRandomQuestions(questionsArray, count) {
                const shuffled = shuffleArray(questionsArray);
                return shuffled.slice(0, Math.min(count, questionsArray.length));
            }

            function prepareQuestionsForQuiz(questionsArray) {
                // Seleccionar preguntas aleatorias si est√° habilitado
                let questionsToUse = SHUFFLE_QUESTIONS ? 
                    selectRandomQuestions(questionsArray, TOTAL_QUESTIONS_TO_SHOW) : 
                    questionsArray.slice(0, TOTAL_QUESTIONS_TO_SHOW);

                // Mezclar respuestas si est√° habilitado
                if (SHUFFLE_ANSWERS) {
                    questionsToUse = questionsToUse.map(question => {
                        const shuffledAnswers = shuffleArray(question.answers);
                        return {
                            ...question,
                            answers: shuffledAnswers
                        };
                    });
                }

                return questionsToUse;
            }

            function prepareQuestionsForQuizWithCount(questionsArray, count) {
                // Seleccionar preguntas aleatorias si est√° habilitado
                let questionsToUse = SHUFFLE_QUESTIONS ? 
                    selectRandomQuestions(questionsArray, count) : 
                    questionsArray.slice(0, count);

                // Mezclar respuestas si est√° habilitado
                if (SHUFFLE_ANSWERS) {
                    questionsToUse = questionsToUse.map(question => {
                        const shuffledAnswers = shuffleArray(question.answers);
                        return {
                            ...question,
                            answers: shuffledAnswers
                        };
                    });
                }

                return questionsToUse;
            }

            const questions = [
            {
                question: "Seg√∫n la ONU, ¬øqu√© porcentaje de las aguas residuales dom√©sticas a nivel mundial NO se tratan de forma segura?",
                answers: [
                { text: "Cerca del 20%", correct: false },
                { text: "Alrededor del 30%", correct: false },
                { text: "42%", correct: true },
                { text: "M√°s del 80%", correct: false }
                ]
            },
            {
                question: "¬øCu√°ntas personas en el mundo, seg√∫n datos de la ONU, carecen de acceso a servicios de agua potable gestionados de forma segura?",
                answers: [
                { text: "500 millones", correct: false },
                { text: "1,200 millones", correct: false },
                { text: "2,200 millones", correct: true },
                { text: "3,500 millones", correct: false }
                ]
            },          
            {
                question: "La ONU promueve la 'gesti√≥n integrada de los recursos h√≠dricos'. ¬øQu√© significa esto?",
                answers: [
                { text: "Usar solo agua embotellada.", correct: false },
                { text: "Que cada pa√≠s gestione su agua sin cooperaci√≥n.", correct: false },
                { text: "Un enfoque coordinado que considera el agua, la tierra y los recursos relacionados.", correct: true },
                { text: "Privatizar todos los servicios de agua.", correct: false }
                ]
            },
            {
                question: "¬øQu√© porcentaje de la poblaci√≥n mundial carece de servicios b√°sicos de higiene, como un lugar para lavarse las manos con agua y jab√≥n?",
                answers: [
                { text: "Aproximadamente 1 de cada 10 personas", correct: false },
                { text: "Aproximadamente 1 de cada 4 personas (25%)", correct: true },
                { text: "Aproximadamente la mitad de la poblaci√≥n", correct: false },
                { text: "Menos del 5%", correct: false }
                ]
            },
            {
                question: "En M√©xico, ¬øqu√© porcentaje del agua se pierde en fugas en los sistemas de distribuci√≥n municipales?",
                answers: [
                { text: "Alrededor del 10%", correct: false },
                { text: "Cerca del 25%", correct: false },
                { text: "Aproximadamente el 40%", correct: true },
                { text: "M√°s del 60%", correct: false }
                ]
            },
            {
                question: "¬øCu√°l es el principal uso del agua en M√©xico, consumiendo m√°s del 70% del total?",
                answers: [
                { text: "Industria", correct: false },
                { text: "Abastecimiento p√∫blico", correct: false },
                { text: "Generaci√≥n de energ√≠a", correct: false },
                { text: "Agricultura", correct: true }
                ]
            },
            {
                question: "Seg√∫n el derecho humano al agua, ¬øcu√°ntos litros por persona al d√≠a se consideran suficientes para cubrir necesidades b√°sicas?",
                answers: [
                { text: "Entre 50 y 100 litros", correct: true },
                { text: "20 litros", correct: false },
                { text: "200 litros", correct: false },
                { text: "No hay una cantidad definida", correct: false }
                ]
            },
            {
                question: "En M√©xico, ¬øqu√© instituci√≥n es la m√°xima autoridad federal en la administraci√≥n de las 'Aguas Nacionales'?",
                answers: [
                { text: "La Comisi√≥n Nacional del Agua (CONAGUA)", correct: true },
                { text: "La Secretar√≠a de Medio Ambiente y Recursos Naturales (SEMARNAT)", correct: false },
                { text: "La Comisi√≥n Nacional de los Derechos Humanos (CNDH)", correct: false },
                { text: "La Secretar√≠a de Salud", correct: false }
                ]
            },
            {
                question: "¬øQu√© es la 'huella h√≠drica'?",
                answers: [
                { text: "La cantidad de agua que llueve en un a√±o.", correct: false },
                { text: "El volumen total de agua dulce usada para producir bienes y servicios.", correct: true },
                { text: "La profundidad de un r√≠o.", correct: false },
                { text: "La marca que deja el agua en el suelo.", correct: false }
                ]
            },
            {
                question: "A nivel mundial, ¬øcu√°ntos ni√±os menores de cinco a√±os mueren cada d√≠a por enfermedades relacionadas con agua y saneamiento inseguros?",
                answers: [
                { text: "Alrededor de 100", correct: false },
                { text: "Cerca de 500", correct: false },
                { text: "Aproximadamente 1,000", correct: true },
                { text: "M√°s de 5,000", correct: false }
                ]
            },
            {
                question: "En la legislaci√≥n mexicana, las Aguas Nacionales son inalienables. ¬øQu√© significa esto?",
                answers: [
                { text: "Que se pueden vender libremente.", correct: false },
                { text: "Que no se pueden vender o ceder permanentemente.", correct: true },
                { text: "Que su uso es exclusivo del gobierno.", correct: false },
                { text: "Que no pagan impuestos.", correct: false }
                ]
            },
        {
            question: "¬øQu√© es un acu√≠fero sobreexplotado?",
            answers: [
            { text: "Un acu√≠fero con agua de muy buena calidad.", correct: false },
            { text: "Un acu√≠fero del que se extrae m√°s agua de la que se recarga naturalmente.", correct: true },
            { text: "Un r√≠o subterr√°neo muy grande.", correct: false },
            { text: "Un acu√≠fero que se comparte entre dos pa√≠ses.", correct: false }
            ]
        },
        {
            question: "Seg√∫n UNICEF, ¬øqu√© porcentaje de las escuelas en M√©xico NO ofrec√≠a agua potable para beber a sus estudiantes?",
            answers: [
            { text: "15%", correct: false },
            { text: "32%", correct: false },
            { text: "58%", correct: true },
            { text: "80%", correct: false }
            ]
        },
        {
            question: "El concepto de huella h√≠drica se divide en tres colores. ¬øQu√© representa el 'agua gris'?",
            answers: [
            { text: "El agua de lluvia.", correct: false },
            { text: "El agua extra√≠da de r√≠os y acu√≠feros.", correct: false },
            { text: "El volumen de agua para diluir contaminantes.", correct: true },
            { text: "El agua almacenada en glaciares.", correct: false }
            ]
        },
        {
            question: "¬øCu√°l es la Norma Oficial Mexicana que establece los l√≠mites de contaminantes en las descargas de aguas residuales a cuerpos de agua nacionales?",
            answers: [
                { text: "NOM-001-SEMARNAT-1996", correct: true },
                { text: "NOM-002-SEMARNAT-1996", correct: false },
                { text: "NOM-003-SEMARNAT-1996", correct: false },
                { text: "NOM-004-SEMARNAT-1996", correct: false }
            ]
        },
        {
            question: "A nivel mundial, ¬øen qui√©n recae principalmente la responsabilidad de recolectar agua en los hogares sin acceso directo?",
            answers: [
                { text: "Las mujeres", correct: true },
                { text: "Los ni√±os", correct: false },
                { text: "Los ancianos", correct: false },
                { text: "Los hombres", correct: false }
            ]
        },
        {
            question: "¬øQu√© porcentaje de toda el agua de la Tierra es salada?",
            answers: [
            { text: "Alrededor del 50%", correct: false },
            { text: "Cerca del 75%", correct: false },
            { text: "El 97.5%", correct: true },
            { text: "El 85%", correct: false }
            ]
        },
        {
            question: "En M√©xico, ¬øqui√©n es responsable de reparar las fugas de agua en las redes de distribuci√≥n de las ciudades?",
            answers: [
            { text: "CONAGUA", correct: false },
            { text: "Los organismos operadores de cada municipio.", correct: true },
            { text: "El gobierno federal.", correct: false },
            { text: "Cada ciudadano en su calle.", correct: false }
            ]
        },
        {
            question: "¬øCu√°ntas personas en el mundo todav√≠a practican la defecaci√≥n al aire libre?",
            answers: [
            { text: "Menos de 100 millones", correct: false },
            { text: "419 millones", correct: true },
            { text: "Cerca de 1,000 millones", correct: false },
            { text: "M√°s de 2,000 millones", correct: false }
            ]
        },
        {
            question: "El cambio clim√°tico est√° afectando los recursos h√≠dricos de M√©xico. ¬øCu√°l es una de las consecuencias directas?",
            answers: [
            { text: "El aumento del nivel de los lagos.", correct: false },
            { text: "La desaparici√≥n acelerada de los glaciares.", correct: true },
            { text: "Lluvias m√°s suaves y constantes.", correct: false },
            { text: "Menos huracanes en las costas.", correct: false }
            ]
        },
        {
            question: "¬øQu√© programa de la UNESCO se dedica a la investigaci√≥n, gesti√≥n y educaci√≥n sobre los recursos h√≠dricos?",
            answers: [
            { text: "El Programa Hidrol√≥gico Internacional (PHI)", correct: true },
            { text: "El Programa de las Naciones Unidas para el Desarrollo (PNUD)", correct: false },
            { text: "El Programa de las Naciones Unidas para el Medio Ambiente (PNUMA)", correct: false },
            { text: "El Fondo Mundial para la Naturaleza (WWF)", correct: false }
            ]
        },
        {
            question: "¬øQu√© porcentaje de las aguas residuales municipales se trata en M√©xico?",
            answers: [
            { text: "Casi el 100%", correct: false },
            { text: "Alrededor del 50%", correct: true },
            { text: "Menos del 20%", correct: false },
            { text: "El 75%", correct: false }
            ]
        },
        {
            question: "Para lograr el ODS 6 en 2030, ¬øcu√°ntas veces se necesita acelerar el ritmo de progreso actual para el agua potable gestionada de forma segura?",
            answers: [
            { text: "2 veces", correct: false },
            { text: "6 veces", correct: true },
            { text: "10 veces", correct: false },
            { text: "No se necesita acelerar", correct: false }
            ]
        },
        {
            question: "¬øQu√© es el 'agua virtual'?",
            answers: [
            { text: "Agua creada en un laboratorio.", correct: false },
            { text: "El agua utilizada a lo largo de toda la cadena de producci√≥n de un art√≠culo.", correct: true },
            { text: "Agua que se vende por internet.", correct: false },
            { text: "Un tipo de agua purificada.", correct: false }
            ]
        },
        {
            question: "En zonas de conflicto, los ni√±os tienen casi 3 veces m√°s probabilidades de morir por enfermedades diarreicas que por...",
            answers: [
                { text: "Desnutrici√≥n", correct: true },
                { text: "Violencia", correct: false },
                { text: "Falta de atenci√≥n m√©dica", correct: false },
                { text: "Contaminaci√≥n", correct: false }
            ]
        },
        {
            question: "¬øQu√© regi√≥n de M√©xico presenta el mayor grado de presi√≥n h√≠drica, superando el 130%?",
            answers: [
                { text: "Noroeste", correct: true },
                { text: "Centro", correct: false },
                { text: "Oeste", correct: false },
                { text: "Este", correct: false }
            ]
        },
        {
            question: "¬øCu√°ntos litros de agua se necesitan para producir los alimentos que una persona consume en un d√≠a?",
            answers: [
            { text: "Entre 100 y 200 litros", correct: false },
            { text: "Entre 2,000 y 5,000 litros", correct: true },
            { text: "Menos de 50 litros", correct: false },
            { text: "M√°s de 10,000 litros", correct: false }
            ]
        },
        {
            question: "Verdadero o Falso: Desperdiciar comida tambi√©n significa desperdiciar agua.",
            answers: [
            { text: "Verdadero", correct: true },
            { text: "Falso", correct: false }
            ]
        },
        {
            question: "¬øCu√°ntas personas viven en pa√≠ses con estr√©s h√≠drico?",
            answers: [
            { text: "Alrededor de 500 millones", correct: false },
            { text: "M√°s de 2,000 millones", correct: true },
            { text: "Menos de 100 millones", correct: false },
            { text: "Casi toda la poblaci√≥n mundial", correct: false }
            ]
        },
        {
            question: "Para obtener legalmente el derecho a usar 'Aguas Nacionales' en M√©xico, un particular necesita un...",
            answers: [
                { text: "Permiso de la CONAGUA", correct: true },
                { text: "T√≠tulo de propiedad", correct: false },
                { text: "Licencia de uso de suelo", correct: false },
                { text: "Ninguno", correct: false }
            ]
        },
        {
            question: "¬øQu√© porcentaje de la lluvia en M√©xico regresa a la atm√≥sfera por evapotranspiraci√≥n?",
            answers: [
            { text: "Cerca del 21%", correct: false },
            { text: "Aproximadamente el 72.5%", correct: true },
            { text: "Menos del 10%", correct: false },
            { text: "El 50%", correct: false }
            ]
        },
        {
            question: "Seg√∫n UNICEF, ¬øqu√© porcentaje de las escuelas en M√©xico carec√≠a de inodoros suficientes para sus alumnos?",
            answers: [
            { text: "5%", correct: false },
            { text: "19%", correct: true },
            { text: "35%", correct: false },
            { text: "50%", correct: false }
            ]
        },
        {
            question: "El derecho humano al agua establece que el tiempo para recolectarla no debe exceder los...",
            answers: [
            { text: "10 minutos", correct: false },
            { text: "30 minutos", correct: true },
            { text: "60 minutos", correct: false },
            { text: "2 horas", correct: false }
            ]
        },
        {
            question: "¬øQu√© significa el acr√≥nimo WASH?",
            answers: [
                { text: "Agua, Saneamiento e Higiene", correct: true },
                { text: "Wellness y Salud", correct: false },
                { text: "Agua y Saneamiento", correct: false },
                { text: "Ninguna de las anteriores", correct: false }
            ]
        },
        {
            question: "¬øQu√© es la 'Cultura del Agua' promovida por CONAGUA?",
            answers: [
            { text: "Un festival anual sobre el agua.", correct: false },
            { text: "Un programa para fomentar el uso responsable y ahorro del agua.", correct: true },
            { text: "Una ley que proh√≠be el desperdicio.", correct: false },
            { text: "Un impuesto sobre el consumo de agua.", correct: false }
            ]
        },
        {
            question: "A nivel mundial, ¬øqu√© porcentaje de las extracciones de agua dulce son para uso industrial?",
            answers: [
            { text: "5%", correct: false },
            { text: "16%", correct: true },
            { text: "30%", correct: false },
            { text: "50%", correct: false }
            ]
        },
        {
            question: "La NOM-001-SEMARNAT-2021 cambi√≥ el indicador de coliformes fecales por uno m√°s preciso, que es...",
            answers: [
            { text: "Amoniaco", correct: false },
            { text: "Escherichia coli", correct: true },
            { text: "Cloro residual", correct: false },
            { text: "Plomo", correct: false }
        ]
        },
        {
            question: "¬øCu√°ntas personas en el mundo carecen de acceso a saneamiento gestionado de forma segura?",
            answers: [
            { text: "1,000 millones", correct: false },
            { text: "3,500 millones", correct: true },
            { text: "500 millones", correct: false },
            { text: "5,000 millones", correct: false }
        ]
        },
        {
            question: "Aproximadamente, ¬øqu√© porcentaje del territorio de M√©xico se considera √°rido o semi√°rido?",
            answers: [
            { text: "25% (un cuarto)", correct: false },
            { text: "67% (dos terceras partes)", correct: true },
            { text: "10% (una d√©cima parte)", correct: false },
            { text: "90% (casi todo)", correct: false }
            ]
        },
        {
            question: "Por cada d√≥lar invertido en agua y saneamiento, ¬øcu√°l es el retorno econ√≥mico promedio?",
            answers: [
            { text: "1 d√≥lar", correct: false },
            { text: "4.3 d√≥lares", correct: true },
            { text: "10 d√≥lares", correct: false },
            { text: "No hay retorno econ√≥mico", correct: false }
            ]
        },
        {
            question: "¬øQu√© es la recarga de un acu√≠fero?",
            answers: [
            { text: "Ponerle una tapa al pozo.", correct: false },
            { text: "El proceso por el cual el agua se infiltra y rellena el acu√≠fero.", correct: true },
            { text: "Pagar los derechos de agua.", correct: false },
            { text: "Medir la profundidad del agua.", correct: false }
            ]
        },
        {
            question: "En M√©xico, ¬øqu√© tipo de instrumento otorga CONAGUA a un municipio para el servicio de agua potable?",
            answers: [
            { text: "Una Concesi√≥n", correct: false },
            { text: "Una Asignaci√≥n", correct: true },
            { text: "Un Contrato", correct: false },
            { text: "Una Licencia", correct: false }
            ]
        },
        {
            question: "A nivel mundial, 1 de cada 4 centros de salud carece de...",
            answers: [
                { text: "Agua potable", correct: true },
                { text: "Saneamiento", correct: false },
                { text: "Electricidad", correct: false },
                { text: "Personal m√©dico", correct: false }
            ]
        },
        {
            question: "El aumento de la temperatura global provoca que el agua de lagos y embalses retenga menos...",
            answers: [
                { text: "Ox√≠geno", correct: false },
                { text: "Nutrientes", correct: true },
                { text: "Contaminantes", correct: false },
                { text: "Calor", correct: false }
            ]
        },
        {
            question: "¬øQu√© porcentaje de la poblaci√≥n mundial ten√≠a acceso a saneamiento gestionado de forma segura en 2022?",
            answers: [
            { text: "85%", correct: false },
            { text: "57%", correct: true },
            { text: "73%", correct: false },
            { text: "41%", correct: false }
            ]
        },
        {
            question: "La falta de instalaciones sanitarias adecuadas en las escuelas afecta especialmente a...",
            answers: [
            { text: "Los maestros.", correct: false },
            { text: "Las adolescentes durante su menstruaci√≥n.", correct: true },
            { text: "Los ni√±os m√°s peque√±os.", correct: false },
            { text: "El personal de limpieza.", correct: false }
            ]
        },
        {
            question: "¬øQu√© porcentaje del agua dulce de la Tierra es utilizable y disponible para el ser humano?",
            answers: [
            { text: "10%", correct: false },
            { text: "0.5%", correct: true },
            { text: "5%", correct: false },                
            { text: "2.5%", correct: false }
            ]
        }
    ];

            // Manejo de botones de dificultad
            const difficultyButtons = document.querySelectorAll('.difficulty-btn');
            let selectedDifficulty = 10; // Por defecto normal

            difficultyButtons.forEach(button => {
                button.addEventListener('click', () => {
                    // Remover selecci√≥n anterior
                    difficultyButtons.forEach(btn => {
                        btn.classList.remove('selected');
                        btn.style.background = 'white';
                        btn.style.color = '#66a6ff';
                    });
                    
                    // Seleccionar nuevo
                    button.classList.add('selected');
                    button.style.background = '#66a6ff';
                    button.style.color = 'white';
                    
                    selectedDifficulty = parseInt(button.dataset.questions);
                });
            });

            startButton.addEventListener('click', startGame);
            restartButton.addEventListener('click', startGame);
            restartButtonCert.addEventListener('click', startGame);
            printButton.addEventListener('click', () => window.print());

            function startGame() {
                playerName = nameInput.value || "H√©roe An√≥nimo"; // Guarda el nombre o usa uno por defecto
                
                // Usar la dificultad seleccionada
                const questionsToShow = selectedDifficulty;
                
                // Preparar preguntas din√°micas
                selectedQuestions = prepareQuestionsForQuizWithCount(questions, questionsToShow);
                maxQuestions = selectedQuestions.length;
                
                currentQuestionIndex = 0;
                score = 0;
                startScreen.classList.remove('active');
                resultScreen.classList.remove('active');
                certificateScreen.classList.remove('active');
                questionScreen.classList.add('active');
                
                // Actualizar contador total de preguntas en la interfaz
                updateQuestionCounter();
                showNextQuestion();
            }

            function showNextQuestion() {
                resetState();
                if (currentQuestionIndex < selectedQuestions.length) {
                    showQuestion(selectedQuestions[currentQuestionIndex]);
                    updateQuestionCounter();
                } else {
                    showResults();
                }
            }

            function updateQuestionCounter() {
                const questionCounter = document.getElementById('question-counter');
                const progressBar = document.getElementById('progress-bar');
                
                if (questionCounter && selectedQuestions) {
                    questionCounter.textContent = `Pregunta ${currentQuestionIndex + 1} de ${selectedQuestions.length}`;
                }
                
                if (progressBar && selectedQuestions) {
                    const progress = ((currentQuestionIndex + 1) / selectedQuestions.length) * 100;
                    progressBar.style.width = `${progress}%`;
                }
            }

            function showQuestion(question) {
                questionText.innerText = question.question;
                question.answers.forEach(answer => {
                    const button = document.createElement('button');
                    button.innerText = answer.text;
                    button.classList.add('btn');
                    if (answer.correct) {
                        button.dataset.correct = answer.correct;
                    }
                    button.addEventListener('click', selectAnswer);
                    answerButtons.appendChild(button);
                });
            }

            function resetState() {
                feedback.innerText = '';
                while (answerButtons.firstChild) {
                    answerButtons.removeChild(answerButtons.firstChild);
                }
            }

            function selectAnswer(e) {
                const selectedButton = e.target;
                const correct = selectedButton.dataset.correct === 'true';

                if (correct) {
                    score++;
                    feedback.innerText = "¬°Correcto! ‚úîÔ∏è";
                    feedback.style.color = '#28a745';
                } else {
                    feedback.innerText = "Incorrecto. ‚ùå";
                    feedback.style.color = '#dc3545';
                }

                Array.from(answerButtons.children).forEach(button => {
                    setStatusClass(button, button.dataset.correct === 'true');
                    button.disabled = true;
                });

                setTimeout(() => {
                    currentQuestionIndex++;
                    showNextQuestion();
                }, 2000);
            }

            function setStatusClass(element, correct) {
                if (correct) {
                    element.classList.add('correct');
                } else {
                    element.classList.add('wrong');
                }
            }

            function showResults() {
                questionScreen.classList.remove('active');
                
                const percentage = (score / selectedQuestions.length) * 100;
                
                // Otorgar certificado si responde correctamente 80% o m√°s
                if (percentage >= 80) {
                    certificateScreen.classList.add('active');
                    certificateName.innerText = playerName;
                    const today = new Date();
                    const options = { year: 'numeric', month: 'long', day: 'numeric' };
                    certificateDateText.innerText = `Otorgado el ${today.toLocaleDateString('es-MX', options)}`;
                    
                    // Actualizar el texto del certificado con el porcentaje obtenido
                    const certificateScore = document.getElementById('certificate-score');
                    if (certificateScore) {
                        certificateScore.innerText = `${score}/${selectedQuestions.length} preguntas correctas (${Math.round(percentage)}%)`;
                    }
                } else {
                    resultScreen.classList.add('active');
                    scoreSpan.innerText = score;
                    totalQuestionsSpan.innerText = selectedQuestions.length;

                    let message = "";
                    if (percentage >= 70) {
                        message = `¬°Muy cerca! Obtuviste ${Math.round(percentage)}%. Necesitas 80% para obtener el certificado. ¬°Int√©ntalo de nuevo! üéØ`;
                    } else if (percentage >= 50) {
                        message = `¬°Bien hecho! Obtuviste ${Math.round(percentage)}%. Sigue aprendiendo para obtener el certificado (80%). üòä`;
                    } else {
                        message = `Obtuviste ${Math.round(percentage)}%. Hay oportunidad para aprender m√°s sobre este vital recurso. ¬°No te rindas! üå±`;
                    }
                    resultMessage.innerText = message;
                }
            }
        });
    </script>
</body>
</html>